<div class="product-detail-container" *ngIf="!isLoading && product">
  <!-- Breadcrumb -->
  <nav class="breadcrumb-nav">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a routerLink="/">
          <i class="fas fa-home"></i> Trang chủ
        </a>
      </li>
      <li class="breadcrumb-item" *ngIf="product.category">
        <a>{{ product.category.name }}</a>
      </li>
      <li class="breadcrumb-item active">{{ product.name }}</li>
    </ol>
  </nav>

  <!-- Main Product Section -->
  <div class="product-main">
    <!-- Product Images -->
    <div class="product-images">
      <div class="main-image">
        <img [src]="getProductImageUrl(product)" [alt]="product.name" />
        <div class="stock-badge" *ngIf="!isInStock()">
          <i class="fas fa-times-circle"></i> Hết hàng
        </div>
      </div>
    </div>

    <!-- Product Info -->
    <div class="product-info-section">
      <!-- Category Badge -->
      <div class="category-badge" *ngIf="product.category">
        <i class="fas fa-tag"></i> {{ product.category.name }}
      </div>

      <!-- Product Name -->
      <h1 class="product-title">{{ product.name }}</h1>

      <!-- Rating & Reviews -->
      <div class="product-rating">
        <div class="stars">
          <i 
            *ngFor="let star of getStarArray()"
            class="fas fa-star"
            [class.filled]="star === 1"
          ></i>
        </div>
        <span class="rating-text">4.5/5</span>
        <span class="review-count">(0 đánh giá)</span>
      </div>

      <!-- Price -->
      <div class="product-price">
        <span class="current-price">{{ product.price | currency:'VND':'symbol':'1.0-0' }}</span>
      </div>

      <!-- Stock Status -->
      <div class="stock-status" [class.in-stock]="isInStock()" [class.out-of-stock]="!isInStock()">
        <i [class.fa-check-circle]="isInStock()" [class.fa-times-circle]="!isInStock()" class="fas"></i>
        <span *ngIf="isInStock()">Còn {{ product.quantity }} sản phẩm</span>
        <span *ngIf="!isInStock()">Hết hàng</span>
      </div>

      <!-- Description -->
      <div class="product-description" *ngIf="product.description">
        <h3>Mô tả sản phẩm</h3>
        <p>{{ product.description }}</p>
      </div>

      <!-- Quantity Selector -->
      <div class="quantity-selector" *ngIf="isInStock()">
        <label>Số lượng:</label>
        <div class="quantity-controls">
          <button 
            class="qty-btn" 
            (click)="decreaseQuantity()" 
            [disabled]="quantity <= 1"
          >
            <i class="fas fa-minus"></i>
          </button>
          <input 
            type="number" 
            class="qty-input" 
            [(ngModel)]="quantity" 
            [min]="1" 
            [max]="product.quantity"
            readonly
          />
          <button 
            class="qty-btn" 
            (click)="increaseQuantity()" 
            [disabled]="quantity >= product.quantity"
          >
            <i class="fas fa-plus"></i>
          </button>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="product-actions">
        <button 
          class="btn-add-cart" 
          (click)="addToCart()" 
          [disabled]="!isInStock()"
        >
          <i class="fas fa-shopping-cart"></i>
          Thêm vào giỏ hàng
        </button>
        <button 
          class="btn-buy-now" 
          (click)="buyNow()" 
          [disabled]="!isInStock()"
        >
          <i class="fas fa-bolt"></i>
          Mua ngay
        </button>
      </div>

      <!-- Additional Info -->
      <div class="additional-info">
        <div class="info-item">
          <i class="fas fa-truck"></i>
          <span>Miễn phí vận chuyển cho đơn hàng trên 500.000đ</span>
        </div>
        <div class="info-item">
          <i class="fas fa-shield-alt"></i>
          <span>Bảo hành chính hãng 12 tháng</span>
        </div>
        <div class="info-item">
          <i class="fas fa-undo"></i>
          <span>Đổi trả trong vòng 7 ngày</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Product Details Tabs -->
  <div class="product-details-tabs">
    <div class="tab-content active">
      <h3>Thông tin chi tiết</h3>
      <table class="details-table">
        <tr>
          <td class="label">Mã sản phẩm:</td>
          <td class="value">#{{ product.id }}</td>
        </tr>
        <tr>
          <td class="label">Danh mục:</td>
          <td class="value">{{ product.category?.name || 'Chưa phân loại' }}</td>
        </tr>
        <tr>
          <td class="label">Tình trạng:</td>
          <td class="value">
            <span class="badge" [class.badge-success]="isInStock()" [class.badge-danger]="!isInStock()">
              {{ isInStock() ? 'Còn hàng' : 'Hết hàng' }}
            </span>
          </td>
        </tr>
        <tr>
          <td class="label">Số lượng có sẵn:</td>
          <td class="value">{{ product.quantity }} sản phẩm</td>
        </tr>
      </table>
    </div>
  </div>
</div>

<!-- Loading Spinner -->
<div class="loading-container" *ngIf="isLoading">
  <div class="spinner">
    <i class="fas fa-spinner fa-spin"></i>
  </div>
  <p>Đang tải thông tin sản phẩm...</p>
</div>
