<div class="dashboard-container">
  <div class="container-fluid">
    <h2 class="mb-4">Quản lý người dùng</h2>

    <!-- Thanh tìm kiếm và nút tạo -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <input type="text" class="form-control w-auto" placeholder="Tìm kiếm..." style="max-width: 250px;">
      <button class="btn btn-primary">
        <i class="bi bi-plus-circle me-1"></i> Thêm người dùng
      </button>
    </div>

    <!-- Bảng người dùng -->
    <div class="card shadow-sm border-0 rounded-3">
      <div class="card-body p-0">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th class="text-center">#</th>
              <th class="text-center">Username</th>
              <th class="text-center">Status</th>
              <th class="text-center">Active Email</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of users; let i = index">
              <td class="text-center">{{ i + 1 + (currentPage * pageSize) }}</td>

              <!-- Username -->
              <td class="text-center">{{ user.username }}</td>

              <!-- Status -->
              <td class="text-center">
                <span class="badge"
                      [ngClass]="{
                        'bg-success': user.status === 'ACTIVE',
                        'bg-secondary': user.status === 'INACTIVE'
                      }">
                  {{ user.status }}
                </span>
              </td>

              <!-- Active Email -->
              <td class="text-center">
                <i *ngIf="user.verifyEmail" class="bi bi-check-circle-fill text-success fs-5"></i>
                <i *ngIf="!user.verifyEmail" class="bi bi-x-circle-fill text-danger fs-5"></i>
              </td>

              <!-- Action -->
              <td class="text-center">
                <button class="btn btn-sm btn-outline-info me-1"
                        (click)="viewUser(user)">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-sm btn-outline-warning me-1"
                        (click)="editUser(user)">
                  <i class="bi bi-pencil"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger"
                        (click)="deleteUser(user)">
                  <i class="bi bi-trash"></i>
                </button>
              </td>
            </tr>

            <!-- Không có dữ liệu -->
            <tr *ngIf="!loading && users.length === 0">
              <td colspan="5" class="text-center text-muted py-3">
                Không có dữ liệu
              </td>
            </tr>

            <!-- Loading -->
            <tr *ngIf="loading">
              <td colspan="5" class="text-center py-3">
                <div class="spinner-border text-primary" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Phân trang -->
      <div class="card-footer bg-white py-3 d-flex justify-content-between align-items-center">
        <div class="text-muted small">
          Trang {{ currentPage + 1 }} / {{ totalPages }} ({{ totalElements }} người dùng)
        </div>

        <nav>
          <ul class="pagination mb-0">
            <li class="page-item" [class.disabled]="currentPage === 0">
              <button class="page-link" (click)="previousPage()">&laquo;</button>
            </li>

            <li class="page-item"
                *ngFor="let page of [].constructor(totalPages); let i = index"
                [class.active]="currentPage === i">
              <button class="page-link" (click)="goToPage(i)">
                {{ i + 1 }}
              </button>
            </li>

            <li class="page-item" [class.disabled]="currentPage === totalPages - 1">
              <button class="page-link" (click)="nextPage()">&raquo;</button>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>
